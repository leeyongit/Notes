# 服务器监控

IOPS (Input/Output Operations Per Second)，即每秒进行读写（I/O）操作的次数

## LINUX 查看tcp连接数及状态
```sh
netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}'
```

## 查看耗时最高的接口
```sh
awk -F ' ' '{print $14,$4,$7}' access-fshd.fensihudong.com.log   | sort -k1nr | head -n 10
```

## 统计请求次数最多的接口
```sh
grep -v HEAD access-fshd.fensihudong.com.log | awk -F ' ' '{print $7}' | sort | uniq -c | sort -k1nr | head -10
```

## linux下获取占用CPU资源最多的10个进程，可以使用如下命令组合：
```sh
ps aux|head -1;ps aux|grep -v PID|sort -rn -k +3|head
```
## linux下获取占用内存资源最多的10个进程，可以使用如下命令组合：
```sh
ps aux|head -1;ps aux|grep -v PID|sort -rn -k +4|head
```
## 看一下是哪个线程CPU消耗得厉害，可以使用top的-H选项查看线程的情况，使用-p选择指定pid
```sh
top -H -p 18400
```
# 可以使用jstack看看线程的调用栈
```sh
jstack -F 18400 > tmp1.log
grep -A 50 18435 tmp1.log
```

# ServerStatus监控
---
```sh
nohup ./sergate --config=config.json --web-dir=/home/wwwroot/web.fshd.com/public/ServerStatus/ >> /home/wwwroot/web.fshd.com/storage/logs/serverstatus.log 2>&1 &
nohup python client-linux.py &
```
