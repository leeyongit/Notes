你的Redis怎么持久化的?
===================

**面试官:你的Redis怎么持久化的?**
一般我们在生产上采用的持久化策略为:
(1)master关闭持久化
(2)slave开RDB即可，必要的时候AOF和RDB都开启
该策略能够适应绝大部分场景，绝大部分集群架构。

(1)master关闭持久化原因很简单，因为无论哪种持久化方式都会影响redis的性能，哪一种持久化都会造成CPU卡顿，影响对客户端请求的处理。为了保证读写最佳性能，将master的持久化关闭！ RDB持久化 RDB持久化是将当前进程中的数据生成快照保存到硬盘(因此也称作快照持久化)，保存的文件后缀是rdb；当Redis重新启动时，可以读取快照文件恢复数据。 那么RDB持久化的过程，相当于在执行bgsave命令

**AOF持久化**
RDB持久化是将进程数据写入文件，而AOF持久化(即Append Only File持久化)，则是将Redis执行的每次写命令记录到单独的日志文件中。

(2)slave开RDB即可，必要的时候AOF和RDB都开启首先，我先说明一下，我不推荐单开AOF的原因是，基于AOF的数据恢复太慢。 你要想，我们已经做了主从复制，数据已经实现备份，为什么slave还需要开持久化? 因为某一天可能因为某某工程，把机房的电线挖断了，就会导致master和slave机器同时关机。 那么这个时候，我们需要迅速恢复集群，而RDB文件文件小、恢复快，因此灾难恢复常用RDB文件。

[原文](https://zhuanlan.zhihu.com/p/68402040)